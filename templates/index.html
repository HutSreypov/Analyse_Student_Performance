{% extends "base.html" %}
{% block title %}Dashboard{% endblock %}

{% block styles %}
<style>
  .welcome-section {
    background: linear-gradient(135deg, #4361ee, #3f37c9);
    color: white;
    padding: 2rem;
    border-radius: 10px;
    margin-bottom: 2rem;
    box-shadow: 0 4px 20px rgba(67, 97, 238, 0.2);
  }
  
  .stat-card {
    background: white;
    border-radius: 10px;
    padding: 1.5rem;
    margin-bottom: 1.5rem;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
    transition: transform 0.3s ease, box-shadow 0.3s ease;
    border-left: 4px solid var(--primary-color);
  }
  
  .stat-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
  }
  
  .stat-card i {
    font-size: 2.5rem;
    margin-bottom: 1rem;
    color: var(--primary-color);
  }
  
  .stat-card h3 {
    font-size: 2rem;
    font-weight: 700;
    margin-bottom: 0.5rem;
  }
  
  .stat-card p {
    color: #6c757d;
    margin-bottom: 0;
  }
  
  .quick-actions .btn {
    width: 100%;
    margin-bottom: 1rem;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    padding: 0.8rem;
    border-radius: 8px;
    font-weight: 500;
  }
  
  .recent-activity {
    background: white;
    border-radius: 10px;
    padding: 1.5rem;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
  }
  
  .activity-item {
    padding: 1rem 0;
    border-bottom: 1px solid #eee;
    display: flex;
    align-items: flex-start;
    gap: 1rem;
  }
  
  .activity-item:last-child {
    border-bottom: none;
  }
  
  .activity-icon {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    background: rgba(67, 97, 238, 0.1);
    display: flex;
    align-items: center;
    justify-content: center;
    color: var(--primary-color);
    flex-shrink: 0;
  }
  
  .activity-content h6 {
    margin-bottom: 0.25rem;
    font-weight: 600;
  }
  
  .activity-time {
    font-size: 0.8rem;
    color: #6c757d;
  }
  
  .chart-container {
    background: white;
    border-radius: 10px;
    padding: 1.5rem;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
    height: 100%;
  }
  
  .section-title {
    font-size: 1.25rem;
    font-weight: 600;
    margin-bottom: 1.5rem;
    color: #333;
    display: flex;
    align-items: center;
    gap: 0.5rem;
  }
  
  .section-title i {
    color: var(--primary-color);
  }
  
  @media (max-width: 768px) {
    .welcome-section {
      text-align: center;
    }
    
    .stat-card {
      text-align: center;
    }
    
    .stat-card i {
      margin: 0 auto 1rem;
      display: block;
    }
  }
</style>
{% endblock %}

{% block content %}
<div class="welcome-section">
  <div class="d-flex justify-content-between align-items-center flex-wrap">
    <div>
      <h1 class="display-5 fw-bold mb-3">Welcome back, {{ username }}! ðŸ‘‹</h1>
      <p class="mb-0">Here's what's happening with your students today.</p>
    </div>
    <div class="mt-3 mt-md-0">
      <span class="badge bg-light text-primary p-2">Last updated: <span id="currentTime"></span></span>
    </div>
  </div>
</div>

<div class="row g-4 mb-4">
  <!-- Students Card -->
  <div class="col-md-6 col-lg-3">
    <div class="stat-card">
      <i class="fas fa-users"></i>
      <h3>1,248</h3>
      <p>Total Students</p>
      <div class="progress mt-2" style="height: 5px;">
        <div class="progress-bar bg-success" role="progressbar" style="width: 75%" aria-valuenow="75" aria-valuemin="0" aria-valuemax="100"></div>
      </div>
      <small class="text-muted">+12% from last month</small>
    </div>
  </div>
  
  <!-- Average Score Card -->
  <div class="col-md-6 col-lg-3">
    <div class="stat-card">
      <i class="fas fa-chart-line"></i>
      <h3>84.5%</h3>
      <p>Average Score</p>
      <div class="progress mt-2" style="height: 5px;">
        <div class="progress-bar bg-info" role="progressbar" style="width: 85%" aria-valuenow="85" aria-valuemin="0" aria-valuemax="100"></div>
      </div>
      <small class="text-muted">+2.5% from last term</small>
    </div>
  </div>
  
  <!-- Subjects Card -->
  <div class="col-md-6 col-lg-3">
    <div class="stat-card">
      <i class="fas fa-book"></i>
      <h3>12</h3>
      <p>Active Subjects</p>
      <div class="progress mt-2" style="height: 5px;">
        <div class="progress-bar bg-warning" role="progressbar" style="width: 60%" aria-valuenow="60" aria-valuemin="0" aria-valuemax="100"></div>
      </div>
      <small class="text-muted">3 new this semester</small>
    </div>
  </div>
  
  <!-- Performance Card -->
  <div class="col-md-6 col-lg-3">
    <div class="stat-card">
      <i class="fas fa-trophy"></i>
      <h3>92%</h3>
      <p>Pass Rate</p>
      <div class="progress mt-2" style="height: 5px;">
        <div class="progress-bar bg-danger" role="progressbar" style="width: 92%" aria-valuenow="92" aria-valuemin="0" aria-valuemax="100"></div>
      </div>
      <small class="text-muted">+5% from last year</small>
    </div>
  </div>
</div>

<div class="row g-4 mb-4">
  <!-- Performance Chart -->
  <div class="col-lg-8">
    <div class="chart-container">
      <h5 class="section-title"><i class="fas fa-chart-bar"></i> Performance Overview</h5>
      <div style="height: 300px;" class="d-flex align-items-center justify-content-center bg-light rounded">
        <p class="text-muted mb-0">Performance chart will be displayed here</p>
      </div>
    </div>
  </div>
  
  <!-- Quick Actions -->
  <div class="col-lg-4">
    <div class="quick-actions">
      <h5 class="section-title"><i class="fas fa-bolt"></i> Quick Actions</h5>
      <a href="{{ url_for('student_bp.add_student') }}" class="btn btn-primary">
        <i class="fas fa-user-plus"></i> Add New Student
      </a>
      <a href="{{ url_for('score_bp.add_score') }}" class="btn btn-outline-primary">
        <i class="fas fa-plus-circle"></i> Record Score
      </a>
      <a href="{{ url_for('analysis_bp.analysis_index') }}" class="btn btn-outline-primary">
        <i class="fas fa-chart-pie"></i> View Reports
      </a>
      <a href="#" class="btn btn-outline-secondary">
        <i class="fas fa-file-export"></i> Export Data
      </a>
    </div>
  </div>
</div>

<div class="row">
  <!-- Recent Activities -->
  <div class="col-12">
    <div class="recent-activity">
      <div class="d-flex justify-content-between align-items-center mb-4">
        <h5 class="section-title mb-0"><i class="fas fa-history"></i> Recent Activities</h5>
        <a href="#" class="btn btn-sm btn-outline-primary">View All</a>
      </div>
      
      <div class="activity-item">
        <div class="activity-icon">
          <i class="fas fa-user-edit"></i>
        </div>
        <div class="activity-content">
          <h6 class="mb-1">Student Record Updated</h6>
          <p class="mb-1">John Doe's information was updated by Admin</p>
          <span class="activity-time">10 minutes ago</span>
        </div>
      </div>
      
      <div class="activity-item">
        <div class="activity-icon">
          <i class="fas fa-chart-line"></i>
        </div>
        <div class="activity-content">
          <h6 class="mb-1">New Score Recorded</h6>
          <p class="mb-1">Mathematics score added for Sarah Johnson</p>
          <span class="activity-time">2 hours ago</span>
        </div>
      </div>
      
      <div class="activity-item">
        <div class="activity-icon">
          <i class="fas fa-user-graduate"></i>
        </div>
        <div class="activity-content">
          <h6 class="mb-1">New Student Registered</h6>
          <p class="mb-1">Michael Brown joined the system</p>
          <span class="activity-time">Yesterday</span>
        </div>
      </div>
      
      <div class="activity-item">
        <div class="activity-icon">
          <i class="fas fa-file-export"></i>
        </div>
        <div class="activity-content">
          <h6 class="mb-1">Report Generated</h6>
          <p class="mb-1">Class 10A performance report was exported</p>
          <span class="activity-time">2 days ago</span>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}

{% block scripts %}
<script>
  // Update current time
  function updateCurrentTime() {
    const now = new Date();
    const options = { 
      weekday: 'long', 
      year: 'numeric', 
      month: 'long', 
      day: 'numeric',
      hour: '2-digit',
      minute: '2-digit'
    };
    document.getElementById('currentTime').textContent = now.toLocaleDateString('en-US', options);
  }
  
  // Update time immediately and then every minute
  updateCurrentTime();
  setInterval(updateCurrentTime, 60000);
  
  // Initialize tooltips
  document.addEventListener('DOMContentLoaded', function() {
    var tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'));
    var tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
      return new bootstrap.Tooltip(tooltipTriggerEl);
    });
  });
</script>
{% endblock %}
