{% extends "base.html" %}
{% block title %}Dashboard - Student Performance Analytics{% endblock %}

{% block styles %}
<style>
  :root {
    --primary-color: #5e72e4;
    --secondary-color: #2dce89;
    --info-color: #11cdef;
    --warning-color: #fb6340;
    --dark-color: #32325d;
    --light-bg: #f8f9fe;
  }

  body {
    background-color: var(--light-bg);
    color: #525f7f;
  }

  .welcome-section {
    background: linear-gradient(87deg, #5e72e4 0, #825ee4 100%);
    color: white;
    padding: 2.5rem 2rem;
    border-radius: 16px;
    margin-bottom: 2.5rem;
    box-shadow: 0 0 2rem 0 rgba(136, 152, 170, .15);
    position: relative;
    overflow: hidden;
  }

  .welcome-section::before {
    content: '';
    position: absolute;
    top: 0;
    right: 0;
    width: 40%;
    height: 100%;
    background: url("data:image/svg+xml,%3Csvg width='200' height='200' viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath fill='%23ffffff10' d='M44,-45.5C53.4,-34.7,55.9,-17.4,58.4,2.3C60.9,22,63.4,44,54,56.5C44.6,69,23.3,72,-0.7,72.6C-24.6,73.1,-49.2,71.1,-61.2,58.6C-73.2,46.1,-72.6,23,-71.2,1.2C-69.8,-20.6,-67.6,-41.2,-55.6,-52C-43.6,-62.8,-21.8,-63.8,-2.9,-61.5C16,-59.2,34.6,-53.6,44,-45.5Z' transform='translate(100 100)' /%3E%3C/svg%3E") no-repeat;
    background-size: cover;
    opacity: 0.5;
  }
  
  .stat-card {
    background: white;
    border-radius: 12px;
    padding: 1.75rem;
    margin-bottom: 1.5rem;
    box-shadow: 0 0 2rem 0 rgba(136, 152, 170, .1);
    transition: all 0.4s cubic-bezier(0.34, 1.61, 0.7, 1);
    border: none;
    position: relative;
    overflow: hidden;
  }

  .stat-card::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 4px;
    height: 100%;
    background: var(--primary-color);
  }
  
  .stat-card:hover {
    transform: translateY(-8px);
    box-shadow: 0 0 2rem 0 rgba(136, 152, 170, .2);
  }
  
  .stat-card i {
    font-size: 2.25rem;
    margin-bottom: 1.25rem;
    color: var(--primary-color);
    background: rgba(94, 114, 228, 0.1);
    width: 64px;
    height: 64px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .stat-card.students i { color: #5e72e4; background: rgba(94, 114, 228, 0.1); }
  .stat-card.scores i { color: #2dce89; background: rgba(45, 206, 137, 0.1); }
  .stat-card.subjects i { color: #fb6340; background: rgba(251, 99, 64, 0.1); }
  .stat-card.performance i { color: #f5365c; background: rgba(245, 54, 92, 0.1); }
  
  .stat-card h3 {
    font-size: 1.75rem;
    font-weight: 700;
    margin-bottom: 0.5rem;
    color: var(--dark-color);
  }
  
  .stat-card p {
    color: #8898aa;
    margin-bottom: 1rem;
    font-size: 0.875rem;
    font-weight: 500;
  }

  .progress {
    height: 6px;
    border-radius: 3px;
    background-color: #e9ecef;
    margin-bottom: 0.5rem;
  }

  .progress-bar {
    border-radius: 3px;
  }
  
  .quick-actions .btn {
    width: 100%;
    margin-bottom: 1rem;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    padding: 0.9rem 1.25rem;
    border-radius: 8px;
    font-weight: 600;
    font-size: 0.875rem;
    letter-spacing: 0.025em;
    text-transform: uppercase;
    transition: all 0.2s ease-in-out;
    box-shadow: 0 4px 6px rgba(50, 50, 93, 0.11), 0 1px 3px rgba(0, 0, 0, 0.08);
  }

  .quick-actions .btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 7px 14px rgba(50, 50, 93, 0.1), 0 3px 6px rgba(0, 0, 0, 0.08);
  }
  
  .recent-activity {
    background: white;
    border-radius: 12px;
    padding: 1.75rem;
    box-shadow: 0 0 2rem 0 rgba(136, 152, 170, .1);
    height: 100%;
  }

  .recent-activity .section-title {
    color: var(--dark-color);
    font-size: 1.25rem;
    font-weight: 600;
    margin-bottom: 1.5rem;
    padding-bottom: 1rem;
    border-bottom: 1px solid #e9ecef;
  }
  
  .activity-item {
    padding: 1.25rem 0;
    border-bottom: 1px solid #f6f9fc;
    display: flex;
    align-items: flex-start;
    gap: 1rem;
    transition: all 0.2s ease;
  }

  .activity-item:hover {
    background-color: #f8f9fe;
    padding-left: 1rem;
    padding-right: 1rem;
    margin: 0 -1.75rem;
    border-radius: 0;
  }
  
  .activity-item:last-child {
    border-bottom: none;
  }
  
  .activity-icon {
    width: 48px;
    height: 48px;
    border-radius: 12px;
    background: rgba(94, 114, 228, 0.1);
    display: flex;
    align-items: center;
    justify-content: center;
    color: var(--primary-color);
    flex-shrink: 0;
    font-size: 1.25rem;
  }
  
  .activity-content h6 {
    margin-bottom: 0.25rem;
    font-weight: 600;
    color: var(--dark-color);
    font-size: 0.9375rem;
  }
  
  .activity-time {
    font-size: 0.75rem;
    color: #adb5bd;
    font-weight: 500;
  }
  
  .chart-container {
    background: white;
    border-radius: 12px;
    padding: 1.75rem;
    box-shadow: 0 0 2rem 0 rgba(136, 152, 170, .1);
    height: 100%;
  }
  
  .section-title {
    font-size: 1.25rem;
    font-weight: 600;
    margin-bottom: 1.75rem;
    color: var(--dark-color);
    display: flex;
    align-items: center;
    gap: 0.75rem;
  }
  
  .section-title i {
    color: var(--primary-color);
    background: rgba(94, 114, 228, 0.1);
    width: 40px;
    height: 40px;
    border-radius: 12px;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .badge {
    font-weight: 600;
    padding: 0.5em 1em;
    border-radius: 8px;
    font-size: 0.75rem;
    letter-spacing: 0.025em;
  }
  
  @media (max-width: 992px) {
    .welcome-section {
      text-align: center;
      padding: 2rem 1.5rem;
    }
    
    .welcome-section::before {
      display: none;
    }
    
    .stat-card {
      text-align: center;
      padding: 1.5rem;
    }
    
    .stat-card i {
      margin: 0 auto 1.25rem;
    }

    .stat-card::before {
      width: 100%;
      height: 4px;
      top: 0;
      left: 0;
    }
  }
</style>
{% endblock %}

{% block content %}
<div class="welcome-section">
  <div class="d-flex justify-content-between align-items-center flex-wrap">
    <div class="position-relative z-1">
      <h1 class="display-5 fw-bold mb-3">Welcome back, {{ username }}! ðŸ‘‹</h1>
      <p class="mb-0 opacity-90">Here's what's happening with your students today. Track performance, analyze data, and make informed decisions.</p>
    </div>
    <div class="mt-3 mt-md-0 position-relative z-1">
      <span class="badge bg-white-10 text-white border-0 p-2 px-3">
        <i class="far fa-clock me-2"></i>
        <span id="currentTime"></span>
      </span>
    </div>
  </div>
</div>

<div class="row g-4 mb-4">
  <!-- Students Card -->
  <div class="col-md-6 col-xl-3">
    <div class="stat-card students">
      <i class="fas fa-user-graduate"></i>
      <h3>1,248</h3>
      <p>Total Students</p>
      <div class="progress">
        <div class="progress-bar" role="progressbar" style="width: 75%; background-color: #5e72e4;" aria-valuenow="75" aria-valuemin="0" aria-valuemax="100"></div>
      </div>
      <div class="d-flex justify-content-between mt-2">
        <small class="text-muted">+12% from last month</small>
        <small class="fw-bold" style="color: #5e72e4;">75%</small>
      </div>
    </div>
  </div>
  
  <!-- Average Score Card -->
  <div class="col-md-6 col-xl-3">
    <div class="stat-card scores">
      <i class="fas fa-chart-line"></i>
      <h3>84.5%</h3>
      <p>Average Score</p>
      <div class="progress">
        <div class="progress-bar" role="progressbar" style="width: 84.5%; background-color: #2dce89;" aria-valuenow="84.5" aria-valuemin="0" aria-valuemax="100"></div>
      </div>
      <div class="d-flex justify-content-between mt-2">
        <small class="text-muted">+2.5% from last term</small>
        <small class="fw-bold" style="color: #2dce89;">84.5%</small>
      </div>
    </div>
  </div>
  
  <!-- Subjects Card -->
  <div class="col-md-6 col-xl-3">
    <div class="stat-card subjects">
      <i class="fas fa-book-open"></i>
      <h3>12</h3>
      <p>Active Subjects</p>
      <div class="progress">
        <div class="progress-bar" role="progressbar" style="width: 60%; background-color: #fb6340;" aria-valuenow="60" aria-valuemin="0" aria-valuemax="100"></div>
      </div>
      <div class="d-flex justify-content-between mt-2">
        <small class="text-muted">3 new this semester</small>
        <small class="fw-bold" style="color: #fb6340;">60%</small>
      </div>
    </div>
  </div>
  
  <!-- Performance Card -->
  <div class="col-md-6 col-xl-3">
    <div class="stat-card performance">
      <i class="fas fa-trophy"></i>
      <h3>92%</h3>
      <p>Pass Rate</p>
      <div class="progress">
        <div class="progress-bar" role="progressbar" style="width: 92%; background-color: #f5365c;" aria-valuenow="92" aria-valuemin="0" aria-valuemax="100"></div>
      </div>
      <div class="d-flex justify-content-between mt-2">
        <small class="text-muted">+5% from last term</small>
        <small class="fw-bold" style="color: #f5365c;">92%</small>
      </div>
      <small class="text-muted">+5% from last year</small>
    </div>
  </div>
</div>

<div class="row g-4 mb-4">
  <!-- Performance Chart -->
  <div class="col-lg-8">
    <div class="chart-container">
      <h5 class="section-title"><i class="fas fa-chart-bar"></i> Performance Overview</h5>
      <div style="height: 300px;" class="d-flex align-items-center justify-content-center bg-light rounded">
        <p class="text-muted mb-0">Performance chart will be displayed here</p>
      </div>
    </div>
  </div>
  
  <!-- Quick Actions -->
  <div class="col-lg-4">
    <div class="quick-actions">
      <h5 class="section-title"><i class="fas fa-bolt"></i> Quick Actions</h5>
      <a href="{{ url_for('student_bp.add_student') }}" class="btn btn-primary">
        <i class="fas fa-user-plus"></i> Add New Student
      </a>
      <a href="{{ url_for('score_bp.add_score') }}" class="btn btn-outline-primary">
        <i class="fas fa-plus-circle"></i> Record Score
      </a>
      <a href="{{ url_for('analysis_bp.analysis_index') }}" class="btn btn-outline-primary">
        <i class="fas fa-chart-pie"></i> View Reports
      </a>
      <a href="#" class="btn btn-outline-secondary">
        <i class="fas fa-file-export"></i> Export Data
      </a>
    </div>
  </div>
</div>

<div class="row">
  <!-- Recent Activities -->
  <div class="col-12">
    <div class="recent-activity">
      <div class="d-flex justify-content-between align-items-center mb-4">
        <h5 class="section-title mb-0"><i class="fas fa-history"></i> Recent Activities</h5>
        <a href="#" class="btn btn-sm btn-outline-primary">View All</a>
      </div>
      
      <div class="activity-item">
        <div class="activity-icon">
          <i class="fas fa-user-edit"></i>
        </div>
        <div class="activity-content">
          <h6 class="mb-1">Student Record Updated</h6>
          <p class="mb-1">John Doe's information was updated by Admin</p>
          <span class="activity-time">10 minutes ago</span>
        </div>
      </div>
      
      <div class="activity-item">
        <div class="activity-icon">
          <i class="fas fa-chart-line"></i>
        </div>
        <div class="activity-content">
          <h6 class="mb-1">New Score Recorded</h6>
          <p class="mb-1">Mathematics score added for Sarah Johnson</p>
          <span class="activity-time">2 hours ago</span>
        </div>
      </div>
      
      <div class="activity-item">
        <div class="activity-icon">
          <i class="fas fa-user-graduate"></i>
        </div>
        <div class="activity-content">
          <h6 class="mb-1">New Student Registered</h6>
          <p class="mb-1">Michael Brown joined the system</p>
          <span class="activity-time">Yesterday</span>
        </div>
      </div>
      
      <div class="activity-item">
        <div class="activity-icon">
          <i class="fas fa-file-export"></i>
        </div>
        <div class="activity-content">
          <h6 class="mb-1">Report Generated</h6>
          <p class="mb-1">Class 10A performance report was exported</p>
          <span class="activity-time">2 days ago</span>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}

{% block scripts %}
<script>
  // Update current time
  function updateCurrentTime() {
    const now = new Date();
    const options = { 
      weekday: 'long', 
      year: 'numeric', 
      month: 'long', 
      day: 'numeric',
      hour: '2-digit',
      minute: '2-digit'
    };
    document.getElementById('currentTime').textContent = now.toLocaleDateString('en-US', options);
  }
  
  // Update time immediately and then every minute
  updateCurrentTime();
  setInterval(updateCurrentTime, 60000);
  
  // Initialize tooltips
  document.addEventListener('DOMContentLoaded', function() {
    var tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'));
    var tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
      return new bootstrap.Tooltip(tooltipTriggerEl);
    });
  });
</script>
{% endblock %}
